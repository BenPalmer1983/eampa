FUNCTION d4(uv, s) RESULT (uvout)
!############################################################
IMPLICIT NONE
!############################################################
REAL(kind=DoubleReal), INTENT(IN) :: uv(1:3, 1:3)
REAL(kind=DoubleReal), INTENT(IN) :: s
REAL(kind=DoubleReal) :: uvout(1:3, 1:3)
!############################################################
REAL(kind=DoubleReal) :: d(1:3, 1:3)
!############################################################
d(1:3, 1:3) = 0.0D0
d(1,1) = 1.0D0 / ((1.0D0 - s**2)**(1.0D0/3.0D0))
d(2,2) = 1.0D0 / ((1.0D0 - s**2)**(1.0D0/3.0D0))
d(3,3) = 1.0D0 / ((1.0D0 - s**2)**(1.0D0/3.0D0))
d(2,3) = s / ((1.0D0 - s**2)**(1.0D0/3.0D0))
d(3,2) = s / ((1.0D0 - s**2)**(1.0D0/3.0D0))
uvout(1:3, 1:3) = MATMUL(d(1:3, 1:3), uv(1:3, 1:3))
END FUNCTION d4